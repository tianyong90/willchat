/********************************************
 * REVOLUTION 5.0 EXTENSION - CAROUSEL
 * @version: 1.0.1 (18.08.2015)
 * @requires jquery.themepunch.revolution.js
 * @author ThemePunch
*********************************************/
!function(){var i=jQuery.fn.revolution;jQuery.extend(!0,i,{prepareCarousel:function(e,o,l){l=e.carousel.lastdirection=a(l,e.carousel.lastdirection),t(e),e.carousel.slide_offset_target=r(e),void 0==o?i.carouselToEvalPosition(e,l):s(e,l,!1)},carouselToEvalPosition:function(e,t){var o=e.carousel;t=o.lastdirection=a(t,o.lastdirection);var l="center"===o.horizontal_align?(o.wrapwidth/2-o.slide_width/2-o.slide_globaloffset)/o.slide_width:(0-o.slide_globaloffset)/o.slide_width,r=i.simp(l,e.slideamount,!1),n=r-Math.floor(r),d=0,f=-1*(Math.ceil(r)-r),h=-1*(Math.floor(r)-r);d=n>=.3&&"left"===t||n>=.7&&"right"===t?f:.3>n&&"left"===t||.7>n&&"right"===t?h:d,d="off"===o.infinity?0>r?r:l>e.slideamount-1?l-(e.slideamount-1):d:d,o.slide_offset_target=d*o.slide_width,0!==Math.abs(o.slide_offset_target)?s(e,t,!0):i.organiseCarousel(e,t)},organiseCarousel:function(i,e,t,a){e=void 0===e||"down"==e||"up"==e||null===e||jQuery.isEmptyObject(e)?"left":e;for(var s=i.carousel,o=new Array,l=s.slides.length,r="right"===s.horizontal_align?r=i.width:0,n=0;l>n;n++){var d=n*s.slide_width+s.slide_offset;"on"===s.infinity&&(d=d>s.wrapwidth-s.inneroffset&&"right"==e?s.slide_offset-(s.slides.length-n)*s.slide_width:d,d=d<0-s.inneroffset-s.slide_width&&"left"==e?d+s.maxwidth:d),o[n]=d}var f=999;s.slides&&jQuery.each(s.slides,function(i,a){var r=o[i];"on"===s.infinity&&(r=r>s.wrapwidth-s.inneroffset&&"left"===e?o[0]-(l-i)*s.slide_width:r,r=r<0-s.inneroffset-s.slide_width?"left"==e?r+s.maxwidth:"right"===e?o[l-1]+(i+1)*s.slide_width:r:r);var n=new Object;n.left=r+s.inneroffset;var d="center"===s.horizontal_align?(Math.abs(s.wrapwidth/2)-(n.left+s.slide_width/2))/s.slide_width:(s.inneroffset-n.left)/s.slide_width,h="center"===s.horizontal_align?2:1;if((t&&Math.abs(d)<f||0===d)&&(f=Math.abs(d),s.focused=i),n.width=s.slide_width,n.x=0,n.transformPerspective=1200,n.transformOrigin="50% "+s.vertical_align,"on"===s.fadeout)if("on"===s.vary_fade)n.autoAlpha=1-Math.abs(1/Math.ceil(s.maxVisibleItems/h)*d);else switch(s.horizontal_align){case"center":n.autoAlpha=Math.abs(d)<Math.ceil(s.maxVisibleItems/h-1)?1:1-(Math.abs(d)-Math.floor(Math.abs(d)));break;case"left":n.autoAlpha=1>d&&d>0?1-d:Math.abs(d)>s.maxVisibleItems-1?1-(Math.abs(d)-(s.maxVisibleItems-1)):1;break;case"right":n.autoAlpha=d>-1&&0>d?1-Math.abs(d):d>s.maxVisibleItems-1?1-(Math.abs(d)-(s.maxVisibleItems-1)):1}else n.autoAlpha=Math.abs(d)<Math.ceil(s.maxVisibleItems/h)?1:0;if(void 0!==s.minScale&&s.minScale>0)if("on"===s.vary_scale){n.scale=1-Math.abs(s.minScale/100/Math.ceil(s.maxVisibleItems/h)*d);var w=(s.slide_width-s.slide_width*n.scale)*Math.abs(d)}else{n.scale=d>=1||-1>=d?1-s.minScale/100:(100-s.minScale*Math.abs(d))/100;var w=(s.slide_width-s.slide_width*(1-s.minScale/100))*Math.abs(d)}void 0!==s.maxRotation&&0!=Math.abs(s.maxRotation)&&("on"===s.vary_rotation?(n.rotationY=Math.abs(s.maxRotation)-Math.abs((1-Math.abs(1/Math.ceil(s.maxVisibleItems/h)*d))*s.maxRotation),n.autoAlpha=Math.abs(n.rotationY)>90?0:n.autoAlpha):n.rotationY=d>=1||-1>=d?s.maxRotation:Math.abs(d)*s.maxRotation,n.rotationY=0>d?-1*n.rotationY:n.rotationY),n.x=-1*s.space*d,n.left=Math.floor(n.left),n.x=Math.floor(n.x),void 0!==n.scale?0>d?n.x-w:n.x+w:n.x,n.zIndex=Math.round(100-Math.abs(5*d)),n.transformStyle="flat",punchgs.TweenLite.set(a,n)}),a&&(i.c.find(".next-revslide").removeClass("next-revslide"),jQuery(s.slides[s.focused]).addClass("next-revslide"),i.c.trigger("revolution.nextslide.waiting"));s.wrapwidth/2-s.slide_offset,s.maxwidth+s.slide_offset-s.wrapwidth/2}});var e=function(i){var e=i.carousel;e.infbackup=e.infinity,e.maxVisiblebackup=e.maxVisibleItems,e.slide_globaloffset="none",e.slide_offset=0,e.wrap=i.c.find(".tp-carousel-wrapper"),e.slides=i.c.find(".tp-revslider-slidesli"),0!==e.maxRotation&&punchgs.TweenLite.set(e.wrap,{perspective:1200,transformStyle:"flat"}),void 0!==e.border_radius&&parseInt(e.border_radius,0)>0&&punchgs.TweenLite.set(i.c.find(".tp-revslider-slidesli"),{borderRadius:e.border_radius})},t=function(t){void 0===t.bw&&i.setSize(t);var a=t.carousel,s=i.getHorizontalOffset(t.c,"left"),o=i.getHorizontalOffset(t.c,"right");void 0===a.wrap&&e(t),a.slide_width="on"!==a.stretch?t.gridwidth[t.curWinRange]*t.bw:t.c.width(),a.maxwidth=t.slideamount*a.slide_width,a.maxVisiblebackup>a.slides.length+1&&(a.maxVisibleItems=a.slides.length+2),a.wrapwidth=a.maxVisibleItems*a.slide_width+(a.maxVisibleItems-1)*a.space,a.wrapwidth="auto"!=t.sliderLayout?a.wrapwidth>t.c.closest(".tp-simpleresponsive").width()?t.c.closest(".tp-simpleresponsive").width():a.wrapwidth:a.wrapwidth>t.ul.width()?t.ul.width():a.wrapwidth,a.infinity=a.wrapwidth>=a.maxwidth?"off":a.infbackup,a.wrapoffset="center"===a.horizontal_align?(t.c.width()-o-s-a.wrapwidth)/2:0,a.wrapoffset="auto"!=t.sliderLayout&&t.outernav?0:a.wrapoffset<s?s:a.wrapoffset,"right"===a.horizontal_align?punchgs.TweenLite.set(a.wrap,{left:"auto",right:a.wrapoffset+"px",width:a.wrapwidth,overflow:"hidden"}):punchgs.TweenLite.set(a.wrap,{right:"auto",left:a.wrapoffset+"px",width:a.wrapwidth,overflow:"hidden"}),a.inneroffset="right"===a.horizontal_align?a.wrapwidth-a.slide_width:0,a.realoffset=Math.abs(a.wrap.position().left),a.windhalf=jQuery(window).width()/2},a=function(i,e){return null===i||jQuery.isEmptyObject(i)?e:void 0===i?"right":i},s=function(e,t,s){var o=e.carousel;t=o.lastdirection=a(t,o.lastdirection);var l=new Object;l.from=0,l.to=o.slide_offset_target,void 0!==o.positionanim&&o.positionanim.pause(),o.positionanim=punchgs.TweenLite.to(l,1.2,{from:l.to,onUpdate:function(){o.slide_offset=o.slide_globaloffset+l.from,o.slide_offset=i.simp(o.slide_offset,o.maxwidth),i.organiseCarousel(e,t,!1,!1)},onComplete:function(){o.slide_globaloffset="off"===o.infinity?o.slide_globaloffset+o.slide_offset_target:i.simp(o.slide_globaloffset+o.slide_offset_target,o.maxwidth),o.slide_offset=i.simp(o.slide_offset,o.maxwidth),i.organiseCarousel(e,t,!1,!0);var a=jQuery(e.li[o.focused]);e.c.find(".next-revslide").removeClass("next-revslide"),s&&i.callingNewSlide(e,e.c,a.data("index"))},ease:punchgs.Expo.easeOut})},o=function(i,e){return Math.abs(i)>Math.abs(e)?i>0?i-Math.abs(Math.floor(i/e)*e):i+Math.abs(Math.floor(i/e)*e):i},l=function(i,e,t){var t,t,a=e-i,s=e-t-i;return a=o(a,t),s=o(s,t),Math.abs(a)>Math.abs(s)?s:a},r=function(e){var t=0,a=e.carousel;if(void 0!==a.positionanim&&a.positionanim.kill(),"none"==a.slide_globaloffset)a.slide_globaloffset=t="center"===a.horizontal_align?a.wrapwidth/2-a.slide_width/2:0;else{a.slide_globaloffset=a.slide_offset,a.slide_offset=0;var s=e.c.find(".processing-revslide").index(),o="center"===a.horizontal_align?(a.wrapwidth/2-a.slide_width/2-a.slide_globaloffset)/a.slide_width:(0-a.slide_globaloffset)/a.slide_width;o=i.simp(o,e.slideamount,!1),s=s>=0?s:e.c.find(".active-revslide").index(),s=s>=0?s:0,t="off"===a.infinity?o-s:-l(o,s,e.slideamount),t*=a.slide_width}return t}}(jQuery);